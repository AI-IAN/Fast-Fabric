# Demo Data Integration Guide for Power BI Reports

## Overview
This guide provides step-by-step instructions for connecting the Power BI report templates to the demo dataset generated by the Fabric Fast-Track mock data generator, ensuring <2 second visual load performance.

## Prerequisites
- Power BI Desktop (latest version)
- Access to Fabric workspace with F2+ capacity
- Demo dataset generated from `/ingest/mock_data_generator.py`
- Semantic model deployed from `/model/fabric_fast_track.bim`

## Demo Dataset Specifications

### Generated Data Volume (Optimized for Performance)
```
FactSales:      5,000 transactions (realistic for demo)
FactFinancial:  1,200 GL records (24 months × 50 accounts)
DimCustomers:   1,000 customer records
DimDate:        1,095 date records (3 years)
```

### Data Refresh Strategy
- **Initial Load**: Full refresh of all tables
- **Incremental Updates**: Daily incremental for fact tables
- **Dimension Updates**: Weekly refresh for dimension tables
- **Performance Target**: Complete refresh in <10 minutes

## Connection Setup

### 1. Connect to Fabric Lakehouse
```powerbi
// Data source connection string
let
    Source = Fabric.Lakehouse(
        "https://[workspace].fabric.microsoft.com",
        [
            LakehouseName = "FabricFastTrackLakehouse",
            DirectLakeMode = true
        ]
    )
in
    Source
```

### 2. Configure Direct Lake Tables
```json
{
  "tables": [
    {
      "name": "FactSales",
      "source": "bronze/CRM_System/sales/",
      "mode": "DirectLake",
      "partitioning": "SaleDate"
    },
    {
      "name": "FactFinancial", 
      "source": "bronze/ERP_System/financial/",
      "mode": "DirectLake",
      "partitioning": "Date"
    },
    {
      "name": "DimCustomers",
      "source": "bronze/CRM_System/customers/",
      "mode": "DirectLake"
    }
  ]
}
```

## Report Template Import Process

### Executive KPI Dashboard
1. **Open Power BI Desktop**
2. **Import Template**: Use `exec_kpi_template.json` as reference
3. **Apply Theme**: Import `fabric_fast_track_theme.json`
4. **Connect Data**: Point to semantic model
5. **Configure Visuals**: Following template specifications

#### Visual Configuration Example
```json
{
  "revenue_card": {
    "visual_type": "card",
    "data_field": "[Total Revenue]",
    "format": "$#,0,,M",
    "position": {"x": 40, "y": 40, "width": 200, "height": 120},
    "performance": {
      "cache_duration": "1 hour",
      "query_reduction": true
    }
  }
}
```

### Operations Drill-Down Dashboard
1. **Multi-Page Setup**: Configure two pages (Sales Ops, Customer Ops)
2. **Drill-Through**: Enable customer and product detail pages
3. **Cross-Filtering**: Limit to essential interactions
4. **Row Limits**: Configure appropriate limits per visual

#### Drill-Through Configuration
```json
{
  "drill_through_pages": [
    {
      "name": "Customer Detail",
      "trigger_field": "DimCustomers[CustomerID]",
      "target_visuals": [
        "customer_transaction_history",
        "customer_trend_analysis"
      ]
    }
  ]
}
```

### Financial Variance Dashboard
1. **Budget Integration**: Configure budget vs actual calculations
2. **Fiscal Calendar**: Set fiscal year start (July)
3. **Variance Calculations**: Implement conditional formatting
4. **Financial Ratios**: Configure gauge and KPI visuals

## Performance Validation

### Load Time Testing
```javascript
// Performance test script
const dashboardTests = [
  {
    report: "Executive KPI",
    visuals: [
      {name: "Revenue Card", target: "< 0.5s"},
      {name: "Revenue Trend", target: "< 1.5s"},
      {name: "Regional Sales", target: "< 1.0s"}
    ]
  },
  {
    report: "Operations Drill-Down", 
    visuals: [
      {name: "Sales Matrix", target: "< 2.0s"},
      {name: "Customer Map", target: "< 1.5s"},
      {name: "Product Table", target: "< 1.0s"}
    ]
  }
];
```

### F2 Capacity Validation
```json
{
  "capacity_limits": {
    "memory_usage": "< 3GB",
    "cpu_utilization": "< 70%", 
    "concurrent_users": "≤ 15",
    "query_timeout": "< 120s"
  },
  "performance_targets": {
    "visual_load": "< 2 seconds",
    "cross_filter": "< 500ms",
    "drill_through": "< 1 second"
  }
}
```

## Demo Scenarios

### Executive Demo (5 minutes)
1. **Revenue Overview**: Show current revenue vs growth
2. **Regional Performance**: Drill into top regions
3. **Customer Analysis**: Highlight top customer segments
4. **Financial Health**: Display key ratios and trends

### Operations Demo (10 minutes)
1. **Sales Pipeline**: Show conversion funnel and win rates
2. **Rep Performance**: Rank sales representatives
3. **Product Analysis**: Identify top-performing products
4. **Customer Segmentation**: Analyze by size and industry
5. **Drill-Through**: Demonstrate customer detail analysis

### Finance Demo (8 minutes)
1. **P&L Analysis**: Revenue, expenses, and margin trends
2. **Budget Variance**: Actual vs budget comparison
3. **Cash Flow**: Working capital and cash conversion cycle
4. **Financial Ratios**: ROA, debt ratios, and efficiency metrics

## Sample Data Highlights

### Revenue Metrics
- **Total Revenue**: $12.5M (demo dataset)
- **Growth Rate**: 15.3% YoY
- **Gross Margin**: 67.2%
- **Active Customers**: 842

### Sales Performance
- **Average Deal Size**: $2,500
- **Win Rate**: 23.4%
- **Sales Velocity**: $34,200/day
- **Top Region**: North America (40% of sales)

### Financial Health
- **Net Income**: $3.2M
- **EBITDA**: $4.1M
- **Working Capital**: $8.7M
- **ROA**: 12.8%

## Troubleshooting

### Common Performance Issues
1. **Slow Visual Load**
   - Check data volume (should be ≤5K rows for FactSales)
   - Verify Direct Lake mode is active
   - Review cross-filtering interactions

2. **Memory Warnings**
   - Reduce concurrent users
   - Clear visual cache
   - Check for data model optimization

3. **Query Timeouts**
   - Simplify complex measures
   - Add date range filters
   - Verify relationship configurations

### Data Connection Issues
1. **Lakehouse Access**
   - Verify workspace permissions
   - Check capacity assignment
   - Validate storage account access

2. **Table Relationships**
   - Ensure all relationships are active
   - Verify cardinality settings
   - Check cross-filter directions

## Deployment Checklist

### Pre-Demo Validation
- [ ] All three report templates created
- [ ] Corporate theme applied consistently
- [ ] Demo dataset connected and refreshed
- [ ] Performance targets validated (<2 seconds)
- [ ] Mobile layouts configured
- [ ] Cross-filtering optimized
- [ ] Drill-through pages working
- [ ] F2 capacity limits confirmed

### Demo Environment Setup
- [ ] Fabric workspace configured
- [ ] Semantic model deployed
- [ ] Sample data refreshed
- [ ] User permissions set
- [ ] Performance monitoring enabled
- [ ] Backup data available
- [ ] Demo scenarios documented
- [ ] Troubleshooting guide ready

### Post-Demo Tasks
- [ ] Performance metrics collected
- [ ] User feedback documented
- [ ] Optimization opportunities identified
- [ ] Capacity planning updated
- [ ] Documentation updated based on learnings

---

*Demo data integration ensures realistic performance validation with <2 second visual load times*
EOF < /dev/null